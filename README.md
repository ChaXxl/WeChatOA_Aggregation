# WeChatOA_Aggregation
微信公众号聚合平台，获取多个公众号的博文进行筛选、过滤，使用户更方便的读取公众号上的所有文章

## 关于token和cookie
进入微信公众平台，扫码登录后在网页地址栏最后面就可以看到`token=xxxxxxxxx`，
进入之后点击图文消息创建新文章，此时按F12点Network监控网络请求，点击上方超链接就会出现新请求，
随便点击一个在Header里就可以找到Cookie，将其复制到id_info.json里就可以

## TODO
- [x] 根据标题筛选可能相似博文，再获取具体内容计算重复率去重，去除大量转载文章
- [ ] 去除广告等无用博文
- [x] 定期爬取，每天早上8:00爬。爬取当前早上6:00到昨天早上6:00的
  - 需要架设服务器，当前支持终端运行`daily_update.sh`文件获取最新文章，我直接上传到hexo博客上，可根据自己需求更改sh文件
- [x] cookie和token过期自动模拟登陆获取
- [x] 已读取的文章定期检测是否博文已删除
- [x] 爬取次数限制，记录最新爬取时间，若一天内爬取过跳过，反复执行直到爬取完成
- [x] github pages搭建个人博客，将公众号聚合平台部署上去（简易版）：https://zejuncao.github.io/

## 实验过程
- 根据标题去重
  - 存在问题：存在标题相同内容不同，例如“今日Github最火的10个Python项目”，该公众号每天都用这个标题，但是内容每日更新
  - [ ] 解决方案1：增加白名单，保留该标题所有博文（不需要）
  - [x] 解决方案2：获取文章具体内容，使用`tree.xpath`提取对应`div`下的所有`//text()`，以列表形式返回，计算两个文本列表的重叠个数占比
    - 存在问题：取`//text()`的方式是按照标签分割，一些加粗的文本会单独列出，导致文章结尾多出很多无意义文本，但在列表长度上占比很大
    - [x] 解决方案1：以重叠字数计算占比，而不是重叠列表长度
    - [x] 解决方案2：改进`tree.xpath`取文本策略，获取所有section和p标签，取此标签下的所有文本并还原顺序

